<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>üóæ ÏùºÎ≥∏Ïñ¥ Îã®Ïñ¥ Í≥µÎ∂Ä - Mobile</title>

    <!-- PWA Î©îÌÉÄ ÌÉúÍ∑∏Îì§ -->
    <meta name="description" content="ÏùºÎ≥∏Ïñ¥ Îã®Ïñ¥ÏôÄ ÌûàÎùºÍ∞ÄÎÇòÎ•º ÏâΩÍ≤å Í≥µÎ∂ÄÌï† Ïàò ÏûàÎäî Î™®Î∞îÏùº Ïï± ^_^">
    <meta name="theme-color" content="#667eea">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="ÏùºÎ≥∏Ïñ¥Í≥µÎ∂Ä">
    <meta name="msapplication-TileColor" content="#667eea">

    <!-- ÏïÑÏù¥ÏΩòÎì§ -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgdmlld0JveD0iMCAwIDE5MiAxOTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTkyIiBmaWxsPSIjNjY3ZWVhIiByeD0iMjQiLz4KPHA+8J+Yr/CfmLDwn5iy8J+Ys+CfmLfwn5i78J+YvvCfmL88L3A+DQo8L3N2Zz4=">
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgdmlld0JveD0iMCAwIDE5MiAxOTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTkyIiBmaWxsPSIjNjY3ZWVhIiByeD0iMjQiLz4KPHA+8J+Yr/CfmLDwn5iy8J+Ys+CfmLfwn5i78J+YvvCfmL88L3A+DQo8L3N2Zz4=">

    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            touch-action: manipulation;
            padding-bottom: 80px; /* Space for bottom nav */
        }

        .app {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Mobile Header with Hamburger */
        .mobile-header {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .hamburger-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 48px;
            height: 48px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            touch-action: manipulation;
        }

        .hamburger-btn:active {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(0.95);
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: white;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Slide-out Menu */
        .side-menu {
            position: fixed;
            top: 0;
            left: -100%;
            width: 80%;
            max-width: 300px;
            height: 100vh;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            z-index: 200;
            transition: left 0.3s ease;
            overflow-y: auto;
            padding: 2rem 1rem;
            box-shadow: 2px 0 15px rgba(0, 0, 0, 0.2);
        }

        .side-menu.open {
            left: 0;
        }

        .menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: rgba(0, 0, 0, 0.5);
            z-index: 150;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .menu-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .menu-close {
            background: none;
            border: none;
            font-size: 2rem;
            color: #667eea;
            cursor: pointer;
            margin-bottom: 1rem;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .menu-item {
            padding: 1rem;
            margin: 0.5rem 0;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 12px;
            border: none;
            width: 100%;
            font-size: 1.1rem;
            color: #667eea;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .menu-item.active {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            font-weight: bold;
        }

        .menu-item:active {
            transform: scale(0.98);
        }

        /* Bottom Navigation (iOS-style) */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-around;
            padding: 0.5rem;
            z-index: 100;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.25rem;
            padding: 0.5rem 1rem;
            background: none;
            border: none;
            color: #95a5a6;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 60px;
            border-radius: 12px;
        }

        .nav-item.active {
            color: #667eea;
            background: rgba(102, 126, 234, 0.1);
        }

        .nav-item:active {
            transform: scale(0.95);
        }

        .nav-icon {
            font-size: 1.5rem;
        }

        .nav-label {
            font-size: 0.75rem;
            font-weight: 500;
        }

        /* Main Content Area */
        .main {
            flex: 1;
            padding: 1rem;
            padding-bottom: 2rem;
        }

        .container {
            width: 100%;
            max-width: 100%;
        }

        /* Card Styles - Mobile Optimized */
        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 1.5rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }

        /* Full-screen Quiz Card for Mobile */
        .quiz-card-fullscreen {
            position: fixed;
            top: 70px;
            left: 1rem;
            right: 1rem;
            bottom: 100px;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 2rem 1.5rem;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        /* Large Touch Targets */
        .quiz-word {
            text-align: center;
            margin: 2rem 0;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .kanji {
            font-size: 5rem;
            color: #9b59b6;
            margin-bottom: 1.5rem;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            line-height: 1.2;
        }

        .hiragana {
            font-size: 3rem;
            color: #2c3e50;
            margin-bottom: 2rem;
            font-weight: 600;
            line-height: 1.2;
        }

        /* Larger Fonts for Mobile */
        .input-group {
            margin: 1rem 0;
        }

        .input-label {
            display: block;
            margin-bottom: 0.75rem;
            font-weight: 600;
            color: #2c3e50;
            font-size: 1.1rem;
        }

        .input-field {
            width: 100%;
            padding: 1.25rem;
            border: 2px solid #e1e8ed;
            border-radius: 16px;
            font-size: 1.2rem;
            transition: all 0.3s ease;
            background: white;
            min-height: 56px;
            -webkit-appearance: none;
            appearance: none;
        }

        .input-field:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 4px rgba(52, 152, 219, 0.15);
        }

        /* Large Touch-Friendly Buttons */
        .btn {
            padding: 1.25rem 2rem;
            border: none;
            border-radius: 16px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 0.5rem 0;
            min-height: 56px;
            width: 100%;
            -webkit-user-select: none;
            user-select: none;
            touch-action: manipulation;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }

        .btn-success {
            background: linear-gradient(45deg, #27ae60, #2ecc71);
            color: white;
            box-shadow: 0 4px 15px rgba(46, 204, 113, 0.3);
        }

        .btn-warning {
            background: linear-gradient(45deg, #f39c12, #e67e22);
            color: white;
            box-shadow: 0 4px 15px rgba(243, 156, 18, 0.3);
        }

        .btn-danger {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            color: white;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
        }

        .btn:active {
            transform: scale(0.98);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .btn-group {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin: 1rem 0;
        }

        /* Score Display */
        .score {
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
            color: #27ae60;
            margin-bottom: 1rem;
            padding: 1rem;
            background: rgba(46, 204, 113, 0.1);
            border-radius: 12px;
        }

        /* Result Messages */
        .result {
            text-align: center;
            font-size: 1.4rem;
            font-weight: bold;
            margin: 1rem 0;
            padding: 1.5rem;
            border-radius: 16px;
            animation: fadeIn 0.5s ease;
        }

        .result.correct {
            background: rgba(46, 204, 113, 0.15);
            color: #27ae60;
            border: 2px solid #27ae60;
        }

        .result.incorrect {
            background: rgba(231, 76, 60, 0.15);
            color: #e74c3c;
            border: 2px solid #e74c3c;
        }

        .result.partial {
            background: rgba(243, 156, 18, 0.15);
            color: #d68910;
            border: 2px solid #f39c12;
        }

        /* Word List - Mobile Optimized */
        .word-list {
            max-height: calc(100vh - 250px);
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            border: 1px solid #e1e8ed;
            border-radius: 16px;
            padding: 0.5rem;
        }

        .word-item {
            padding: 1.25rem;
            border-bottom: 1px solid #e1e8ed;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
            min-height: 56px;
        }

        .word-item:active {
            background: rgba(52, 152, 219, 0.1);
        }

        .word-item:last-child {
            border-bottom: none;
        }

        /* Notification - Mobile Optimized */
        .notification {
            position: fixed;
            top: 80px;
            left: 1rem;
            right: 1rem;
            z-index: 1000;
            padding: 1.25rem;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            font-weight: 500;
            font-size: 1.1rem;
            animation: slideDown 0.3s ease-out;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .notification.success {
            background: rgba(46, 204, 113, 0.95);
            color: white;
        }

        .notification.error {
            background: rgba(231, 76, 60, 0.95);
            color: white;
        }

        .notification.warning {
            background: rgba(241, 196, 15, 0.95);
            color: white;
        }

        .notification.info {
            background: rgba(52, 152, 219, 0.95);
            color: white;
        }

        @keyframes slideDown {
            from {
                transform: translateY(-100%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .notification-close {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            opacity: 0.9;
            margin-left: auto;
            padding: 0;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 32px;
        }

        /* Popup Modal - Mobile Optimized */
        .custom-popup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            padding: 1rem;
        }

        .custom-popup.show {
            opacity: 1;
            visibility: visible;
        }

        .popup-content {
            background: white;
            padding: 2rem 1.5rem;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
            width: 100%;
            max-width: 400px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            transform: scale(0.8);
            transition: transform 0.3s ease;
        }

        .custom-popup.show .popup-content {
            transform: scale(1);
        }

        .popup-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #f1f2f6;
        }

        .popup-title {
            font-size: 1.4rem;
            font-weight: bold;
            color: #2c3e50;
            margin: 0;
        }

        .popup-close {
            background: none;
            border: none;
            font-size: 2rem;
            cursor: pointer;
            color: #7f8c8d;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.2s ease;
            min-width: 40px;
        }

        .popup-close:active {
            background-color: #f1f2f6;
            color: #e74c3c;
        }

        .popup-body {
            margin-bottom: 2rem;
        }

        .popup-message {
            font-size: 1.15rem;
            line-height: 1.6;
            color: #34495e;
            margin-bottom: 1.5rem;
        }

        .popup-buttons {
            display: flex;
            gap: 0.75rem;
            justify-content: flex-end;
        }

        .popup-btn {
            padding: 1rem 1.5rem;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 80px;
            min-height: 48px;
        }

        .popup-btn-primary {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
        }

        .popup-btn-primary:active {
            transform: scale(0.98);
        }

        .popup-btn-secondary {
            background: #ecf0f1;
            color: #34495e;
            border: 2px solid #bdc3c7;
        }

        .popup-btn-secondary:active {
            background: #d5dbdb;
        }

        .popup-btn-success {
            background: linear-gradient(45deg, #27ae60, #2ecc71);
            color: white;
        }

        .popup-btn-danger {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            color: white;
        }

        /* Swipe Indicator */
        .swipe-indicator {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.9rem;
            color: #95a5a6;
            opacity: 0.7;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translate(-50%, 0); }
            50% { transform: translate(-50%, -10px); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Hiragana Hide/Show */
        .hiragana-container {
            position: relative;
            display: inline-block;
            margin: 2rem 0;
        }

        .hiragana-hidden {
            filter: blur(20px);
            color: transparent;
            text-shadow: none;
            user-select: none;
            pointer-events: none;
        }

        .hiragana-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 30px;
            font-size: 1.1rem;
            font-weight: 600;
            box-shadow: 0 8px 25px rgba(52, 152, 219, 0.4);
            animation: pulse 2s infinite;
            border: 2px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            white-space: nowrap;
            z-index: 10;
        }

        @keyframes pulse {
            0%, 100% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.05); }
        }

        /* Favorite Button */
        .quiz-favorite-btn {
            position: absolute;
            top: -10px;
            left: -10px;
            border: none;
            border-radius: 50%;
            width: 56px;
            height: 56px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            z-index: 5;
            color: white;
            backdrop-filter: blur(10px);
        }

        .quiz-favorite-btn:active {
            transform: scale(0.9);
        }

        /* Desktop Version Link */
        .desktop-link {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            padding: 0.75rem 1.5rem;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 20px;
            color: white;
            text-decoration: none;
            font-weight: 600;
            font-size: 0.9rem;
            z-index: 50;
            transition: all 0.3s ease;
        }

        .desktop-link:active {
            transform: translateX(-50%) scale(0.95);
            background: rgba(255, 255, 255, 0.3);
        }

        /* Select Dropdown - Mobile Optimized */
        select {
            width: 100%;
            padding: 1.25rem;
            border: 2px solid #e1e8ed;
            border-radius: 16px;
            font-size: 1.2rem;
            background: white;
            color: #2c3e50;
            min-height: 56px;
            -webkit-appearance: none;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%232c3e50' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 1rem center;
            padding-right: 3rem;
        }

        select:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 4px rgba(52, 152, 219, 0.15);
        }

        /* Loading Spinner */
        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 4px solid white;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 2rem auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Status indicators */
        .status-indicator {
            padding: 1rem 1.25rem;
            border-radius: 16px;
            font-size: 1rem;
            font-weight: 500;
            margin: 1rem 0;
        }

        .status-success {
            background: rgba(46, 204, 113, 0.15);
            color: #27ae60;
            border: 1px solid #27ae60;
        }

        .status-error {
            background: rgba(231, 76, 60, 0.15);
            color: #e74c3c;
            border: 1px solid #e74c3c;
        }

        .status-info {
            background: rgba(52, 152, 219, 0.15);
            color: #3498db;
            border: 1px solid #3498db;
        }

        /* Hangul converter */
        .hangul-converter {
            background: rgba(52, 152, 219, 0.1);
            border: 2px dashed #3498db;
            border-radius: 16px;
            padding: 1.25rem;
            margin: 1rem 0;
        }

        /* Word info display */
        .word-info {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            flex: 1;
        }

        .word-kanji {
            font-size: 1.5rem;
            font-weight: bold;
            color: #9b59b6;
        }

        .word-hiragana {
            font-size: 1.2rem;
            color: #3498db;
        }

        .word-korean {
            font-size: 1rem;
            color: #7f8c8d;
        }

        /* Button actions in word list */
        .word-actions {
            display: flex;
            gap: 0.5rem;
            flex-shrink: 0;
        }

        .icon-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 8px;
            transition: all 0.3s ease;
            min-width: 48px;
            min-height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .icon-btn:active {
            transform: scale(0.9);
            background: rgba(0, 0, 0, 0.05);
        }

        /* Section headers */
        .section-header {
            font-size: 1.3rem;
            font-weight: bold;
            color: #2c3e50;
            margin: 1.5rem 0 1rem 0;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #e1e8ed;
        }

        /* Empty state */
        .empty-state {
            text-align: center;
            padding: 3rem 1rem;
            color: #95a5a6;
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .empty-state-text {
            font-size: 1.2rem;
            margin-bottom: 2rem;
        }

        /* Search bar */
        .search-bar {
            position: relative;
            margin-bottom: 1rem;
        }

        .search-icon {
            position: absolute;
            left: 1.25rem;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.2rem;
            color: #95a5a6;
            pointer-events: none;
        }

        .search-input {
            width: 100%;
            padding: 1.25rem 1.25rem 1.25rem 3.5rem;
            border: 2px solid #e1e8ed;
            border-radius: 16px;
            font-size: 1.1rem;
            background: white;
            min-height: 56px;
        }

        .search-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 4px rgba(52, 152, 219, 0.15);
        }

        /* Candidate buttons */
        .candidate-btn {
            background: rgba(102, 126, 234, 0.1);
            border: 2px solid #667eea;
            color: #667eea;
            padding: 1rem;
            border-radius: 12px;
            margin: 0.5rem 0;
            width: 100%;
            text-align: left;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            min-height: 56px;
        }

        .candidate-btn:active {
            background: rgba(102, 126, 234, 0.2);
            transform: scale(0.98);
        }

        /* Learn mode styles */
        .learn-card {
            min-height: 400px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .learn-answer {
            background: rgba(52, 152, 219, 0.1);
            padding: 1.5rem;
            border-radius: 16px;
            margin: 1rem 0;
            border: 2px solid #3498db;
        }

        /* Quiz type selector */
        .quiz-selector {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
            margin: 1rem 0;
        }

        .quiz-option {
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid #e1e8ed;
            padding: 1.5rem;
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            min-height: 80px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .quiz-option:active {
            transform: scale(0.98);
        }

        .quiz-option.selected {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
            font-weight: bold;
        }

        .quiz-option-title {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .quiz-option-desc {
            font-size: 0.9rem;
            color: #7f8c8d;
        }

        /* Toggle switch */
        .toggle-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem;
            background: rgba(52, 152, 219, 0.05);
            border-radius: 12px;
            margin: 0.5rem 0;
        }

        .toggle-label {
            font-size: 1.1rem;
            color: #2c3e50;
            font-weight: 500;
        }

        .toggle-switch {
            position: relative;
            width: 60px;
            height: 34px;
            background: #bdc3c7;
            border-radius: 34px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .toggle-switch.active {
            background: #3498db;
        }

        .toggle-knob {
            position: absolute;
            top: 4px;
            left: 4px;
            width: 26px;
            height: 26px;
            background: white;
            border-radius: 50%;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .toggle-switch.active .toggle-knob {
            left: 30px;
        }

        /* Responsive adjustments */
        @media (max-width: 375px) {
            .kanji {
                font-size: 4rem;
            }

            .hiragana {
                font-size: 2.5rem;
            }

            .btn {
                font-size: 1.1rem;
                padding: 1.1rem 1.5rem;
            }
        }

        @media (max-width: 320px) {
            .kanji {
                font-size: 3.5rem;
            }

            .hiragana {
                font-size: 2rem;
            }
        }

        /* Landscape mode adjustments */
        @media (orientation: landscape) {
            .quiz-card-fullscreen {
                top: 60px;
                bottom: 70px;
            }

            .kanji {
                font-size: 3.5rem;
                margin-bottom: 1rem;
            }

            .hiragana {
                font-size: 2rem;
                margin-bottom: 1rem;
            }
        }

        /* Smooth scrolling */
        * {
            scroll-behavior: smooth;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <!-- Custom Popup Modal -->
    <div id="customPopup" class="custom-popup">
        <div class="popup-content">
            <div class="popup-header">
                <h3 id="popupTitle" class="popup-title">ÏïåÎ¶º</h3>
                <button class="popup-close" onclick="closeCustomPopup()">√ó</button>
            </div>
            <div class="popup-body">
                <div id="popupMessage" class="popup-message"></div>
            </div>
            <div class="popup-buttons">
                <button id="popupOkBtn" class="popup-btn popup-btn-primary" onclick="closeCustomPopup()">ÌôïÏù∏</button>
                <button id="popupCancelBtn" class="popup-btn popup-btn-secondary" onclick="closeCustomPopup()" style="display: none;">Ï∑®ÏÜå</button>
            </div>
        </div>
    </div>

    <script type="text/babel">
        const { useState, useEffect, useCallback, useRef } = React;

        // Custom popup management functions
        function showCustomPopup(message, title = 'ÏïåÎ¶º', type = 'info', showCancel = false) {
            const popup = document.getElementById('customPopup');
            const titleElement = document.getElementById('popupTitle');
            const messageElement = document.getElementById('popupMessage');
            const okBtn = document.getElementById('popupOkBtn');
            const cancelBtn = document.getElementById('popupCancelBtn');

            titleElement.textContent = title;
            messageElement.textContent = message;

            okBtn.className = 'popup-btn ';
            switch(type) {
                case 'success':
                    okBtn.className += 'popup-btn-success';
                    break;
                case 'error':
                case 'danger':
                    okBtn.className += 'popup-btn-danger';
                    break;
                case 'warning':
                    okBtn.className += 'popup-btn-primary';
                    break;
                default:
                    okBtn.className += 'popup-btn-primary';
            }

            if (showCancel) {
                cancelBtn.style.display = 'inline-block';
            } else {
                cancelBtn.style.display = 'none';
            }

            popup.classList.add('show');

            return new Promise((resolve) => {
                okBtn.onclick = () => {
                    closeCustomPopup();
                    resolve(true);
                };

                if (showCancel) {
                    cancelBtn.onclick = () => {
                        closeCustomPopup();
                        resolve(false);
                    };
                }
            });
        }

        function closeCustomPopup() {
            const popup = document.getElementById('customPopup');
            popup.classList.remove('show');
        }

        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeCustomPopup();
            }
        });

        document.getElementById('customPopup').addEventListener('click', function(event) {
            if (event.target === this) {
                closeCustomPopup();
            }
        });

        // Kanji dictionary (same as desktop)
        const kanjiDict = {
            "„Åå„Å£„Åì„ÅÜ": "Â≠¶Ê†°", "„Åõ„Çì„Åõ„ÅÑ": "ÂÖàÁîü", "„Åå„Åè„Åõ„ÅÑ": "Â≠¶Áîü",
            "„Åü„Åπ„ÇÇ„ÅÆ": "È£ü„ÅπÁâ©", "„Åø„Åö": "Ê∞¥", "„Åò„Åã„Çì": "ÊôÇÈñì",
            "„Å®„ÇÇ„Å†„Å°": "ÂèãÈÅî", "„Åã„Åû„Åè": "ÂÆ∂Êóè", "„Åó„Åî„Å®": "‰ªï‰∫ã",
            "„ÅÑ„Åà": "ÂÆ∂", "„ÅÇ„Åü„Åæ": "È†≠", "„Åì„Åì„Çç": "ÂøÉ",
            "„Å¶„Åå„Åø": "ÊâãÁ¥ô", "„Åß„Çì„Çè": "ÈõªË©±", "„Åè„Çã„Åæ": "Ëªä",
            "„Åà„Åç": "ÈßÖ", "„Å≥„Çá„ÅÜ„ÅÑ„Çì": "ÁóÖÈô¢", "„Åé„Çì„Åì„ÅÜ": "ÈäÄË°å",
            "„Åì„ÅÜ„Åà„Çì": "ÂÖ¨Âúí", "„Å®„Åó„Çá„Åã„Çì": "Âõ≥Êõ∏È§®", "„Åã„ÅÑ„Åó„ÇÉ": "‰ºöÁ§æ",
            "„ÅØ„Å™„Åó": "Ë©±", "„Åπ„Çì„Åç„Çá„ÅÜ": "ÂãâÂº∑", "„Åó„ÇÖ„Åè„Å†„ÅÑ": "ÂÆøÈ°å",
            "„Åß„Çì„Åó„ÇÉ": "ÈõªËªä", "„Åò„Å¶„Çì„Åó„ÇÉ": "Ëá™Ëª¢Ëªä", "„Å≤„Åì„ÅÜ„Åç": "È£õË°åÊ©ü",
            "„Åä„Å®": "Èü≥", "„Åì„Åà": "Â£∞", "„ÇÅ": "ÁõÆ", "„Å¶": "Êâã",
            "„ÅÇ„Åó": "Ë∂≥", "„Åã„Çâ„Å†": "‰Ωì", "„Å≤„Å®": "‰∫∫",
            "„ÅÑ„Å°": "‰∏Ä", "„Å´": "‰∫å", "„Åï„Çì": "‰∏â", "„Çà„Çì": "Âõõ", "„Åî": "‰∫î",
            "„Çç„Åè": "ÂÖ≠", "„Å™„Å™": "‰∏É", "„ÅØ„Å°": "ÂÖ´", "„Åç„ÇÖ„ÅÜ": "‰πù", "„Åò„ÇÖ„ÅÜ": "ÂçÅ",
            "„Å≤": "Êó•", "„Å§„Åç": "Êúà", "„Åã": "ÁÅ´", "„Åô„ÅÑ": "Ê∞¥", "„ÇÇ„Åè": "Êú®",
            "„Åç„Çì": "Èáë", "„Å©": "Âúü", "„Å´„Å°": "Êó•", "„Åí„Å§": "Êúà",
            "„ÅÇ„Åã": "Ëµ§", "„ÅÇ„Åä": "Èùí", "„Åó„Çç": "ÁôΩ", "„Åè„Çç": "Èªí", "„Åç„ÅÑ„Çç": "ÈªÑ"
        };

        // Hangul to Hiragana conversion dictionary (same as desktop - truncated for brevity)
        const hangulToHiragana = {
            '„Öè': '„ÅÇ', '„Ö£': '„ÅÑ', '„Öú': '„ÅÜ', '„Öì': '„Åà', '„Öó': '„Åä',
            '„Öë': '„ÇÑ', '„Öï': '„Çà', '„Ö†': '„ÇÜ', '„Öõ': '„Çà', '„Öò': '„Çè', '„Öô': '„Çè„ÅÑ', '„Öö': '„ÅÜ„Åá',
            '„Öù': '„ÅÜ„Åâ', '„Öû': '„ÅÜ„Åá', '„Öü': '„ÅÜ„ÅÑ', '„Ö¢': '„ÅÜ„ÅÑ', '„Öî': '„Åà', '„Öê': '„Åà',
            '„Ñ±': '„Åå', '„Ñ¥': '„Çì', '„Ñ∑': '„Å†', '„Ñπ': '„Çâ', '„ÖÅ': '„Åæ', '„ÖÇ': '„Å∞',
            '„ÖÖ': '„Åï', '„Öá': '', '„Öà': '„Åò', '„Öä': '„Å°', '„Öã': '„Åã', '„Öå': '„Åü',
            '„Öç': '„Å±', '„Öé': '„ÅØ',
            '„ÖÖ„ÖÖ': '„Å£', '„Å£': '„Å£',
            'ÏôÄ': '„Çè', 'Ïôú': '„Çè„ÅÑ', 'Ïô∏': '„ÅÜ„Åá', 'Ïõ®': '„ÅÜ„Åá', 'ÏúÑ': '„ÅÜ„ÅÑ', 'Ïùò': '„ÅÜ„ÅÑ',
            'Í∞Ä': '„Åå', 'Í∞∏': '„Åé„ÇÉ', 'Í±∞': '„Åí', 'Í≤®': '„Åé„Åá', 'Í≥†': '„Åî', 'Íµê': '„Åé„Çá', 'Íµ¨': '„Åê', 'Í∑ú': '„Åé„ÇÖ', 'Í∑∏': '„Åê', 'Í∏∞': '„Åé', 'Í∞ú': '„Åå„ÅÑ', 'Í≤å': '„Åí',
            'ÎÇò': '„Å™', 'ÎÉê': '„Å´„ÇÉ', 'ÎÑà': '„Å≠', 'ÎÖÄ': '„Å´„Åá', 'ÎÖ∏': '„ÅÆ', 'Îá®': '„Å´„Çá', 'ÎàÑ': '„Å¨', 'Îâ¥': '„Å´„ÇÖ', 'Îäê': '„Å¨', 'Îãà': '„Å´', 'ÎÇ¥': '„Å™„ÅÑ', 'ÎÑ§': '„Å≠',
            'Îã§': '„Å†', 'Îåú': '„Å¢„ÇÉ', 'Îçî': '„Åß', 'Îéå': '„Å¢„Åá', 'ÎèÑ': '„Å©', 'Îê¥': '„Å¢„Çá', 'Îëê': '„Å•', 'ÎìÄ': '„Å¢„ÇÖ', 'Îìú': '„Å•', 'Îîî': '„Å¢', 'ÎåÄ': '„Å†„ÅÑ', 'Îç∞': '„Åß',
            'Îùº': '„Çâ', 'Îû¥': '„Çä„ÇÉ', 'Îü¨': '„Çå', 'Î†§': '„Çä„Åá', 'Î°ú': '„Çç', 'Î£å': '„Çä„Çá', 'Î£®': '„Çã', 'Î•ò': '„Çä„ÇÖ', 'Î•¥': '„Çã', 'Î¶¨': '„Çä', 'Îûò': '„Çâ„ÅÑ', 'Î†à': '„Çå',
            'Îßà': '„Åæ', 'Î®Ä': '„Åø„ÇÉ', 'Î®∏': '„ÇÅ', 'Î©∞': '„Åø„Åá', 'Î™®': '„ÇÇ', 'Î¨ò': '„Åø„Çá', 'Î¨¥': '„ÇÄ', 'ÎÆ§': '„Åø„ÇÖ', 'ÎØÄ': '„ÇÄ', 'ÎØ∏': '„Åø', 'Îß§': '„Åæ„ÅÑ', 'Î©î': '„ÇÅ',
            'Î∞î': '„Å∞', 'Î±å': '„Å≥„ÇÉ', 'Î≤Ñ': '„Åπ', 'Î≤º': '„Å≥„Åá', 'Î≥¥': '„Åº', 'Îµ§': '„Å≥„Çá', 'Î∂Ä': '„Å∂', 'Î∑∞': '„Å≥„ÇÖ', 'Î∏å': '„Å∂', 'ÎπÑ': '„Å≥', 'Î∞∞': '„Å∞„ÅÑ', 'Î≤†': '„Åπ',
            'ÏÇ¨': '„Åï', 'ÏÉ§': '„Åó„ÇÉ', 'ÏÑú': '„Åõ', 'ÏÖî': '„Åó„Åá', 'ÏÜå': '„Åù', 'Ïáº': '„Åó„Çá', 'Ïàò': '„Åô', 'Ïäà': '„Åó„ÇÖ', 'Ïä§': '„Åô', 'Ïãú': '„Åó', 'ÏÉà': '„Åï„ÅÑ', 'ÏÑ∏': '„Åõ',
            'ÏïÑ': '„ÅÇ', 'Ïïº': '„ÇÑ', 'Ïñ¥': '„Åà', 'Ïó¨': '„ÅÑ„Åá', 'Ïò§': '„Åä', 'Ïöî': '„Çà', 'Ïö∞': '„ÅÜ', 'Ïú†': '„ÇÜ', 'Ïúº': '„ÅÜ', 'Ïù¥': '„ÅÑ', 'Ïï†': '„ÅÇ„ÅÑ', 'Ïóê': '„Åà',
            'Ïûê': '„Åñ', 'Ïüà': '„Åò„ÇÉ', 'Ï†Ä': '„Åú', 'Ï†∏': '„Åò„Åá', 'Ï°∞': '„Åû', 'Ï£†': '„Åò„Çá', 'Ï£º': '„Åö', 'Ï•¨': '„Åò„ÇÖ', 'Ï¶à': '„Åö', 'ÏßÄ': '„Åò', 'Ïû¨': '„Åñ„ÅÑ', 'Ï†ú': '„Åú',
            'Ï∞®': '„Å°„ÇÉ', 'Ï±†': '„Å°„ÇÉ', 'Ï≤ò': '„Å°„Åá', 'Ï≥ê': '„Å°„Åá', 'Ï¥à': '„Å°„Çá', 'Ïµ∏': '„Å°„Çá', 'Ï∂î': '„Å°„ÇÖ', 'Ï∏Ñ': '„Å°„ÇÖ', 'Ï∏†': '„Å§', 'Ïπò': '„Å°', 'Ï±Ñ': '„Å°„ÇÉ„ÅÑ', 'Ï≤¥': '„Å°„Åá',
            'Ïπ¥': '„Åã', 'Ï∫¨': '„Åç„ÇÉ', 'Ïª§': '„Åë', 'Ïºú': '„Åç„Åá', 'ÏΩî': '„Åì', 'ÏøÑ': '„Åç„Çá', 'Ïø†': '„Åè', 'ÌÅê': '„Åç„ÇÖ', 'ÌÅ¨': '„Åè', 'ÌÇ§': '„Åç', 'Ï∫ê': '„Åã„ÅÑ', 'ÏºÄ': '„Åë',
            'ÌÉÄ': '„Åü', 'ÌÉ∏': '„Å°„ÇÉ', 'ÌÑ∞': '„Å¶', 'ÌÖ®': '„Å°„Åá', 'ÌÜ†': '„Å®', 'Ìàê': '„Å°„Çá', 'Ìà¨': '„Å§', 'Ìäú': '„Å°„ÇÖ', 'Ìä∏': '„Å§', 'Ìã∞': '„Å°', 'ÌÉú': '„Åü„ÅÑ', 'ÌÖå': '„Å¶',
            'Ìåå': '„Å±', 'ÌçÑ': '„Å¥„ÇÉ', 'Ìçº': '„Å∫', 'Ìé¥': '„Å¥„Åá', 'Ìè¨': '„ÅΩ', 'Ìëú': '„Å¥„Çá', 'Ìë∏': '„Å∑', 'Ìì®': '„Å¥„ÇÖ', 'ÌîÑ': '„Å∑', 'Ìîº': '„Å¥', 'Ìå®': '„Å±„ÅÑ', 'Ìéò': '„Å∫',
            'Ìïò': '„ÅØ', 'Ìñê': '„Å≤„ÇÉ', 'Ìóà': '„Å∏', 'ÌòÄ': '„Å≤„Åá', 'Ìò∏': '„Åª', 'Ìö®': '„Å≤„Çá', 'ÌõÑ': '„Åµ', 'Ìú¥': '„Å≤„ÇÖ', 'Ìùê': '„Åµ', 'Ìûà': '„Å≤', 'Ìï¥': '„ÅØ„ÅÑ', 'Ìó§': '„Å∏',
            // Add more mappings as needed from the original file
            'Í∞Ñ': '„Åå„Çì', 'Í±¥': '„Åí„Çì', 'Í≥§': '„Åî„Çì', 'Íµ∞': '„Åê„Çì', 'Í∑º': '„Åê„Çì', 'Í∏¥': '„Åé„Çì',
            'ÎÇú': '„Å™„Çì', 'ÎÑå': '„Å≠„Çì', 'ÎÖº': '„ÅÆ„Çì', 'Îàà': '„Å¨„Çì', 'Îäî': '„Å¨„Çì', 'Îãå': '„Å´„Çì',
            'Îã®': '„Å†„Çì', 'Îçò': '„Åß„Çì', 'Îèà': '„Å©„Çì', 'Îëî': '„Å•„Çì', 'Îì†': '„Å•„Çì', 'Îîò': '„Å¢„Çì',
            'ÎûÄ': '„Çâ„Çì', 'Îü∞': '„Çå„Çì', 'Î°†': '„Çç„Çì', 'Î£¨': '„Çã„Çì', 'Î•∏': '„Çã„Çì', 'Î¶∞': '„Çä„Çì',
            'Îßå': '„Åæ„Çì', 'Î®º': '„ÇÅ„Çì', 'Î™¨': '„ÇÇ„Çì', 'Î¨∏': '„ÇÄ„Çì', 'ÎØÑ': '„ÇÄ„Çì', 'ÎØº': '„Åø„Çì',
            'Î∞ò': '„Å∞„Çì', 'Î≤à': '„Åπ„Çì', 'Î≥∏': '„Åº„Çì', 'Î∂Ñ': '„Å∂„Çì', 'Î∏ê': '„Å∂„Çì', 'Îπà': '„Å≥„Çì',
            'ÏÇ∞': '„Åï„Çì', 'ÏÑ†': '„Åõ„Çì', 'ÏÜê': '„Åù„Çì', 'Ïàú': '„Åô„Çì', 'Ïä®': '„Åô„Çì', 'Ïã†': '„Åó„Çì',
            'Ïïà': '„ÅÇ„Çì', 'Ïñ∏': '„Åà„Çì', 'Ïò®': '„Åä„Çì', 'Ïö¥': '„ÅÜ„Çì', 'ÏùÄ': '„ÅÜ„Çì', 'Ïù∏': '„ÅÑ„Çì',
            'Ïûî': '„Åñ„Çì', 'Ï†Ñ': '„Åú„Çì', 'Ï°¥': '„Åû„Çì', 'Ï§Ä': '„Åö„Çì', 'Ï¶å': '„Åö„Çì', 'ÏßÑ': '„Åò„Çì',
            'Ï∞¨': '„Å°„ÇÉ„Çì', 'Ï≤ú': '„Å°„Åá„Çì', 'Ï¥å': '„Å°„Çá„Çì', 'Ï∂ò': '„Å°„ÇÖ„Çì', 'Ï∏§': '„Å°„ÇÖ„Çì', 'Ïπú': '„Å°„Çì',
            'Ïπ∏': '„Åã„Çì', 'Ïª®': '„Åë„Çì', 'ÏΩò': '„Åì„Çì', 'Ïø§': '„Åè„Çì', 'ÌÅ∞': '„Åè„Çì', 'ÌÇ®': '„Åç„Çì',
            'ÌÉÑ': '„Åü„Çì', 'ÌÑ¥': '„Å¶„Çì', 'ÌÜ§': '„Å®„Çì', 'Ìà∞': '„Å§„Çì', 'Ìäº': '„Å§„Çì', 'Ìã¥': '„Å°„Çì',
            'Ìåê': '„Å±„Çì', 'ÌéÄ': '„Å∫„Çì', 'Ìè∞': '„ÅΩ„Çì', 'Ìëº': '„Å∑„Çì', 'Ìîà': '„Å∑„Çì', 'ÌïÄ': '„Å¥„Çì',
            'Ìïú': '„ÅØ„Çì', 'Ìóå': '„Å∏„Çì', 'Ìòº': '„Åª„Çì', 'Ìõà': '„Åµ„Çì', 'Ìùî': '„Åµ„Çì', 'Ìûå': '„Å≤„Çì',
        };

        function JapaneseStudyApp() {
            const [currentTab, setCurrentTab] = useState('quiz');
            const [words, setWords] = useState({});
            const [currentWord, setCurrentWord] = useState(null);
            const [userAnswer, setUserAnswer] = useState('');
            const [score, setScore] = useState(0);
            const [totalQuestions, setTotalQuestions] = useState(0);
            const [result, setResult] = useState(null);
            const [isAnswerSubmitted, setIsAnswerSubmitted] = useState(false);
            const [quizStarted, setQuizStarted] = useState(false);
            const [usedWords, setUsedWords] = useState(new Set());
            const [quizCompleted, setQuizCompleted] = useState(false);
            const [hideHiragana, setHideHiragana] = useState(false);
            const [menuOpen, setMenuOpen] = useState(false);

            // Word sets management
            const [wordSets, setWordSets] = useState({});
            const [currentSetId, setCurrentSetId] = useState('default');
            const [setNames, setSetNames] = useState({ default: 'Í∏∞Î≥∏ Îã®Ïñ¥Ïû•' });

            // Word form states
            const [newKanji, setNewKanji] = useState('');
            const [newHiragana, setNewHiragana] = useState('');
            const [newKorean, setNewKorean] = useState('');
            const [hangulInput, setHangulInput] = useState('');
            const [convertedHiragana, setConvertedHiragana] = useState('');
            const [kanjiStatus, setKanjiStatus] = useState('');
            const [kanjiCandidates, setKanjiCandidates] = useState([]);
            const [showNotification, setShowNotification] = useState(false);
            const [notificationMessage, setNotificationMessage] = useState('');
            const [notificationType, setNotificationType] = useState('success');

            // Edit mode states
            const [isEditMode, setIsEditMode] = useState(false);
            const [editingWordKey, setEditingWordKey] = useState(null);

            // Favorites states
            const [favoriteWords, setFavoriteWords] = useState({});
            const [showFavoritesOnly, setShowFavoritesOnly] = useState(false);
            const [quizMode, setQuizMode] = useState('all');
            const [quizType, setQuizType] = useState('korean');
            const [convertedQuizAnswer, setConvertedQuizAnswer] = useState('');

            // Both quiz states
            const [userKoreanAnswer, setUserKoreanAnswer] = useState('');
            const [userHiraganaAnswer, setUserHiraganaAnswer] = useState('');
            const [convertedHiraganaAnswer, setConvertedHiraganaAnswer] = useState('');
            const [bothQuizResult, setBothQuizResult] = useState({ korean: null, hiragana: null });

            // Quiz selection states
            const [selectedRange, setSelectedRange] = useState('all');
            const [selectedType, setSelectedType] = useState('korean');

            // Loading and errors
            const [isLoadingNextQuestion, setIsLoadingNextQuestion] = useState(false);
            const [wrongAnswers, setWrongAnswers] = useState([]);
            const [showWrongAnswers, setShowWrongAnswers] = useState(false);
            const [wrongAnswerFavorites, setWrongAnswerFavorites] = useState({});

            // Combined word set states
            const [selectedSetsForCombined, setSelectedSetsForCombined] = useState({});
            const [showSetSelector, setShowSetSelector] = useState(false);
            const [selectedSetsForMerge, setSelectedSetsForMerge] = useState({});
            const [showMergeSelector, setShowMergeSelector] = useState(false);
            const [newMergedSetName, setNewMergedSetName] = useState('');
            const [selectedSetsForDelete, setSelectedSetsForDelete] = useState({});
            const [showDeleteSelector, setShowDeleteSelector] = useState(false);

            // Search states
            const [searchQuery, setSearchQuery] = useState('');

            // Kanji lookup states
            const [kanjiInput, setKanjiInput] = useState('');
            const [kanjiResult, setKanjiResult] = useState(null);
            const [kanjiError, setKanjiError] = useState('');
            const [kanjiLoading, setKanjiLoading] = useState(false);

            // Learn mode states
            const [learnStarted, setLearnStarted] = useState(false);
            const [currentLearnWord, setCurrentLearnWord] = useState(null);
            const [learnWordIndex, setLearnWordIndex] = useState(0);
            const [learnWords, setLearnWords] = useState([]);
            const [showAnswer, setShowAnswer] = useState(false);
            const [learnMode, setLearnMode] = useState('all');

            // Swipe handling for quiz navigation
            const touchStartX = useRef(0);
            const touchEndX = useRef(0);

            const handleTouchStart = (e) => {
                touchStartX.current = e.touches[0].clientX;
            };

            const handleTouchEnd = (e) => {
                touchEndX.current = e.changedTouches[0].clientX;
                handleSwipe();
            };

            const handleSwipe = () => {
                if (touchStartX.current - touchEndX.current > 50) {
                    // Swipe left - next question
                    if (isAnswerSubmitted && !quizCompleted) {
                        nextQuestion();
                    }
                }
                if (touchEndX.current - touchStartX.current > 50) {
                    // Swipe right - could be used for other actions
                }
            };

            // Create hiragana to Korean map
            const createHiraganaToKoreanMap = () => {
                const reverseMap = {};
                Object.entries(hangulToHiragana).forEach(([korean, hiragana]) => {
                    if (hiragana && hiragana.trim() !== '') {
                        reverseMap[hiragana] = korean;
                    }
                });
                reverseMap['„Éº'] = 'Ïö∞';
                reverseMap['„Éª'] = '';
                return reverseMap;
            };

            const hiraganaToKorean = createHiraganaToKoreanMap();

            const convertHiraganaToKorean = (hiraganaText) => {
                if (!hiraganaText) return '';
                let result = '';
                let i = 0;

                while (i < hiraganaText.length) {
                    let matched = false;
                    for (let len = Math.min(4, hiraganaText.length - i); len >= 1; len--) {
                        const substr = hiraganaText.substring(i, i + len);
                        if (hiraganaToKorean[substr]) {
                            result += hiraganaToKorean[substr];
                            i += len;
                            matched = true;
                            break;
                        }
                    }
                    if (!matched) {
                        result += hiraganaText.charAt(i);
                        i++;
                    }
                }
                return result;
            };

            // Initialize data
            useEffect(() => {
                loadAllWordSets();
                loadFavoriteWords();
                loadSelectedSets();
            }, []);

            useEffect(() => {
                if (wordSets[currentSetId]) {
                    setWords(wordSets[currentSetId]);
                }
            }, [currentSetId, wordSets]);

            const loadAllWordSets = () => {
                const savedSets = localStorage.getItem('japaneseWordSets');
                const savedSetNames = localStorage.getItem('japaneseSetNames');

                if (savedSets && savedSetNames) {
                    try {
                        const parsedSets = JSON.parse(savedSets);
                        const parsedNames = JSON.parse(savedSetNames);
                        setWordSets(parsedSets);
                        setSetNames(parsedNames);

                        const savedCurrentSet = localStorage.getItem('currentWordSet') || 'default';
                        if (parsedSets[savedCurrentSet]) {
                            setCurrentSetId(savedCurrentSet);
                            setWords(parsedSets[savedCurrentSet]);
                        }

                        setTimeout(() => updateCombinedWordSet(), 100);
                    } catch (error) {
                        console.error('Ï†ÄÏû•Îêú ÏÑ∏Ìä∏ Î°úÎìú Ïã§Ìå®:', error);
                        setWordSets({});
                        setSetNames({});
                        setWords({});
                        setCurrentSetId('');
                    }
                } else {
                    setWordSets({});
                    setSetNames({});
                    setWords({});
                    setCurrentSetId('');
                }
            };

            const updateCombinedWordSet = () => {
                if (Object.keys(wordSets).length === 0) return;

                let combinedWords = {};
                const hasSelection = Object.keys(selectedSetsForCombined).some(setId => selectedSetsForCombined[setId]);

                Object.entries(wordSets).forEach(([setId, setWords]) => {
                    if (setId !== 'combined') {
                        if (!hasSelection || selectedSetsForCombined[setId]) {
                            Object.assign(combinedWords, setWords);
                        }
                    }
                });

                if (Object.keys(combinedWords).length > 0) {
                    const updatedSets = { ...wordSets, combined: combinedWords };
                    const updatedNames = { ...setNames, combined: 'Ï†ÑÏ≤¥ Îã®Ïñ¥Ïû•' };

                    setWordSets(updatedSets);
                    setSetNames(updatedNames);

                    if (!currentSetId || !updatedSets[currentSetId]) {
                        setCurrentSetId('combined');
                        setWords(combinedWords);
                    }

                    saveAllSets(updatedSets, updatedNames, currentSetId || 'combined');
                } else if (wordSets['combined']) {
                    const updatedSets = { ...wordSets };
                    const updatedNames = { ...setNames };
                    delete updatedSets['combined'];
                    delete updatedNames['combined'];

                    setWordSets(updatedSets);
                    setSetNames(updatedNames);

                    if (currentSetId === 'combined') {
                        const remainingSetIds = Object.keys(updatedSets);
                        const newCurrentSet = remainingSetIds.length > 0 ? remainingSetIds[0] : '';
                        setCurrentSetId(newCurrentSet);
                        setWords(newCurrentSet ? updatedSets[newCurrentSet] : {});
                    }

                    saveAllSets(updatedSets, updatedNames, currentSetId !== 'combined' ? currentSetId : '');
                }
            };

            const saveAllSets = (sets, names, currentSet) => {
                localStorage.setItem('japaneseWordSets', JSON.stringify(sets));
                localStorage.setItem('japaneseSetNames', JSON.stringify(names));
                localStorage.setItem('currentWordSet', currentSet);
            };

            const loadFavoriteWords = () => {
                const savedFavorites = localStorage.getItem('japaneseFavoriteWords');
                if (savedFavorites) {
                    try {
                        const parsedFavorites = JSON.parse(savedFavorites);
                        setFavoriteWords(parsedFavorites);
                    } catch (error) {
                        console.error('Ï¶êÍ≤®Ï∞æÍ∏∞ Î°úÎìú Ïã§Ìå®:', error);
                        setFavoriteWords({});
                    }
                }
            };

            const saveFavoriteWords = (favorites) => {
                localStorage.setItem('japaneseFavoriteWords', JSON.stringify(favorites));
            };

            const loadSelectedSets = () => {
                const savedSelection = localStorage.getItem('selectedSetsForCombined');
                if (savedSelection) {
                    try {
                        const parsedSelection = JSON.parse(savedSelection);
                        setSelectedSetsForCombined(parsedSelection);
                    } catch (error) {
                        console.error('ÏÑ∏Ìä∏ ÏÑ†ÌÉù Î°úÎìú Ïã§Ìå®:', error);
                        setSelectedSetsForCombined({});
                    }
                }
            };

            const showAlert = (message, type = 'info') => {
                setNotificationMessage(message);
                setNotificationType(type);
                setShowNotification(true);
                setTimeout(() => setShowNotification(false), 3000);
            };

            const toggleWordFavorite = (wordKey) => {
                const currentSetFavorites = favoriteWords[currentSetId] || {};
                const isCurrentlyFavorite = currentSetFavorites[wordKey];

                const updatedFavorites = {
                    ...favoriteWords,
                    [currentSetId]: {
                        ...currentSetFavorites,
                        [wordKey]: !isCurrentlyFavorite
                    }
                };

                if (!updatedFavorites[currentSetId][wordKey]) {
                    delete updatedFavorites[currentSetId][wordKey];
                }

                setFavoriteWords(updatedFavorites);
                saveFavoriteWords(updatedFavorites);

                const action = !isCurrentlyFavorite ? 'ÌëúÏãú' : 'Ìï¥Ï†ú';
                showAlert(`‚≠ê '${wordKey}' Îã®Ïñ¥Î•º ${action}ÌñàÏäµÎãàÎã§.`, 'info');
            };

            const getCurrentSetFavorites = () => {
                return favoriteWords[currentSetId] || {};
            };

            const getFilteredWords = () => {
                let filteredWords = words;

                if (showFavoritesOnly) {
                    const currentFavorites = getCurrentSetFavorites();
                    const favoriteWords = {};

                    Object.keys(words).forEach(wordKey => {
                        if (currentFavorites[wordKey]) {
                            favoriteWords[wordKey] = words[wordKey];
                        }
                    });
                    filteredWords = favoriteWords;
                }

                if (searchQuery.trim()) {
                    const query = searchQuery.toLowerCase().trim();
                    const searchedWords = {};

                    Object.entries(filteredWords).forEach(([hiragana, data]) => {
                        const koreanPronunciation = convertHiraganaToKorean(hiragana);
                        const searchTargets = [
                            hiragana,
                            data.kanji || '',
                            data.korean || '',
                            koreanPronunciation,
                        ].map(text => text.toLowerCase());

                        const isMatch = searchTargets.some(target => target.includes(query));

                        if (isMatch) {
                            searchedWords[hiragana] = data;
                        }
                    });
                    filteredWords = searchedWords;
                }

                return filteredWords;
            };

            useEffect(() => {
                if (Object.keys(words).length > 0 && wordSets[currentSetId] && currentSetId !== 'combined') {
                    const updatedSets = {
                        ...wordSets,
                        [currentSetId]: words
                    };
                    setWordSets(updatedSets);
                    saveAllSets(updatedSets, setNames, currentSetId);
                }
            }, [words]);

            useEffect(() => {
                updateCombinedWordSet();
            }, [wordSets, setNames, currentSetId]);

            const convertHangulToHiragana = useCallback((hangul) => {
                let result = '';
                let i = 0;

                while (i < hangul.length) {
                    let found = false;

                    if (i + 3 < hangul.length) {
                        const four = hangul.substr(i, 4);
                        if (hangulToHiragana[four]) {
                            result += hangulToHiragana[four];
                            i += 4;
                            found = true;
                        }
                    }

                    if (!found && i + 2 < hangul.length) {
                        const three = hangul.substr(i, 3);
                        if (hangulToHiragana[three]) {
                            result += hangulToHiragana[three];
                            i += 3;
                            found = true;
                        }
                    }

                    if (!found && i + 1 < hangul.length) {
                        const two = hangul.substr(i, 2);
                        if (hangulToHiragana[two]) {
                            result += hangulToHiragana[two];
                            i += 2;
                            found = true;
                        }
                    }

                    if (!found) {
                        const one = hangul[i];
                        if (hangulToHiragana[one]) {
                            result += hangulToHiragana[one];
                        } else {
                            if (one === '„ÖÖ' && i + 1 < hangul.length) {
                                const nextChar = hangul[i + 1];
                                if (['„Ñ±', '„Ñ¥', '„Ñ∑', '„Ñπ', '„ÖÅ', '„ÖÇ', '„ÖÖ', '„Öà', '„Öä', '„Öã', '„Öå', '„Öç', '„Öé',
                                     '„Ñ≤', '„Ñ∏', '„ÖÉ', '„ÖÜ', '„Öâ'].includes(nextChar)) {
                                    result += '„Å£';
                                } else {
                                    result += one;
                                }
                            } else {
                                result += one;
                            }
                        }
                        i += 1;
                    }
                }

                return result;
            }, []);

            useEffect(() => {
                if (hangulInput) {
                    const converted = convertHangulToHiragana(hangulInput);
                    setConvertedHiragana(converted);
                } else {
                    setConvertedHiragana('');
                }
            }, [hangulInput, convertHangulToHiragana]);

            useEffect(() => {
                if (quizType === 'hiragana' && userAnswer) {
                    const converted = convertHangulToHiragana(userAnswer);
                    setConvertedQuizAnswer(converted);
                } else {
                    setConvertedQuizAnswer('');
                }
            }, [userAnswer, quizType, convertHangulToHiragana]);

            useEffect(() => {
                if (quizType === 'both' && userHiraganaAnswer) {
                    const converted = convertHangulToHiragana(userHiraganaAnswer);
                    setConvertedHiraganaAnswer(converted);
                } else {
                    setConvertedHiraganaAnswer('');
                }
            }, [userHiraganaAnswer, quizType, convertHangulToHiragana]);

            // Quiz functions
            const startQuiz = () => {
                const targetWords = quizMode === 'favorites'
                    ? Object.keys(getCurrentSetFavorites()).reduce((acc, key) => {
                        if (words[key]) acc[key] = words[key];
                        return acc;
                    }, {})
                    : words;

                if (Object.keys(targetWords).length === 0) {
                    showAlert('Îã®Ïñ¥Í∞Ä ÏóÜÏäµÎãàÎã§!', 'warning');
                    return;
                }

                setQuizStarted(true);
                setScore(0);
                setTotalQuestions(0);
                setUsedWords(new Set());
                setQuizCompleted(false);
                setWrongAnswers([]);
                nextQuestion();
            };

            const nextQuestion = () => {
                const targetWords = quizMode === 'favorites'
                    ? Object.keys(getCurrentSetFavorites()).reduce((acc, key) => {
                        if (words[key]) acc[key] = words[key];
                        return acc;
                    }, {})
                    : words;

                const availableWords = Object.keys(targetWords).filter(key => !usedWords.has(key));

                if (availableWords.length === 0) {
                    setQuizCompleted(true);
                    setQuizStarted(false);
                    showAlert(`üéâ ÌÄ¥Ï¶à ÏôÑÎ£å! Ï†êÏàò: ${score}/${totalQuestions}`, 'success');
                    return;
                }

                const randomIndex = Math.floor(Math.random() * availableWords.length);
                const randomKey = availableWords[randomIndex];
                setCurrentWord({ hiragana: randomKey, ...targetWords[randomKey] });
                setUserAnswer('');
                setUserKoreanAnswer('');
                setUserHiraganaAnswer('');
                setConvertedHiraganaAnswer('');
                setResult(null);
                setIsAnswerSubmitted(false);
                setBothQuizResult({ korean: null, hiragana: null });
                setHideHiragana(false);
            };

            const checkAnswer = () => {
                if (!currentWord) return;

                setIsAnswerSubmitted(true);
                setTotalQuestions(prev => prev + 1);
                setUsedWords(prev => new Set([...prev, currentWord.hiragana]));

                if (quizType === 'korean') {
                    const correctAnswer = currentWord.korean.toLowerCase().trim();
                    const userAnswerNormalized = userAnswer.toLowerCase().trim();

                    if (userAnswerNormalized === correctAnswer) {
                        setResult('correct');
                        setScore(prev => prev + 1);
                        showAlert('‚úÖ Ï†ïÎãµÏûÖÎãàÎã§!', 'success');
                    } else {
                        setResult('incorrect');
                        showAlert(`‚ùå ÌãÄÎ†∏ÏäµÎãàÎã§. Ï†ïÎãµ: ${currentWord.korean}`, 'error');
                        setWrongAnswers(prev => [...prev, {
                            question: currentWord.kanji || currentWord.hiragana,
                            hiragana: currentWord.hiragana,
                            correctAnswer: currentWord.korean,
                            userAnswer: userAnswer,
                            type: 'korean'
                        }]);
                    }
                } else if (quizType === 'hiragana') {
                    const correctHiragana = currentWord.hiragana.trim();
                    const userHiraganaConverted = convertedQuizAnswer.trim();

                    if (userHiraganaConverted === correctHiragana) {
                        setResult('correct');
                        setScore(prev => prev + 1);
                        showAlert('‚úÖ Ï†ïÎãµÏûÖÎãàÎã§!', 'success');
                    } else {
                        setResult('incorrect');
                        showAlert(`‚ùå ÌãÄÎ†∏ÏäµÎãàÎã§. Ï†ïÎãµ: ${correctHiragana}`, 'error');
                        setWrongAnswers(prev => [...prev, {
                            question: currentWord.kanji,
                            hiragana: currentWord.hiragana,
                            correctAnswer: correctHiragana,
                            userAnswer: userAnswer,
                            type: 'hiragana'
                        }]);
                    }
                } else if (quizType === 'both') {
                    const correctKorean = currentWord.korean.toLowerCase().trim();
                    const userKoreanNormalized = userKoreanAnswer.toLowerCase().trim();
                    const correctHiragana = currentWord.hiragana.trim();
                    const userHiraganaConverted = convertedHiraganaAnswer.trim();

                    const koreanCorrect = userKoreanNormalized === correctKorean;
                    const hiraganaCorrect = userHiraganaConverted === correctHiragana;

                    setBothQuizResult({ korean: koreanCorrect, hiragana: hiraganaCorrect });

                    if (koreanCorrect && hiraganaCorrect) {
                        setResult('correct');
                        setScore(prev => prev + 1);
                        showAlert('‚úÖ Îëò Îã§ Ï†ïÎãµÏûÖÎãàÎã§!', 'success');
                    } else if (koreanCorrect || hiraganaCorrect) {
                        setResult('partial');
                        showAlert('‚ö†Ô∏è Ìïú Í∞úÎßå Ï†ïÎãµÏûÖÎãàÎã§!', 'warning');
                        setWrongAnswers(prev => [...prev, {
                            question: currentWord.kanji,
                            hiragana: currentWord.hiragana,
                            correctKorean: currentWord.korean,
                            correctHiragana: correctHiragana,
                            userKoreanAnswer,
                            userHiraganaAnswer: userHiraganaAnswer,
                            type: 'both',
                            bothResult: { korean: koreanCorrect, hiragana: hiraganaCorrect }
                        }]);
                    } else {
                        setResult('incorrect');
                        showAlert('‚ùå Îëò Îã§ ÌãÄÎ†∏ÏäµÎãàÎã§!', 'error');
                        setWrongAnswers(prev => [...prev, {
                            question: currentWord.kanji,
                            hiragana: currentWord.hiragana,
                            correctKorean: currentWord.korean,
                            correctHiragana: correctHiragana,
                            userKoreanAnswer,
                            userHiraganaAnswer: userHiraganaAnswer,
                            type: 'both',
                            bothResult: { korean: koreanCorrect, hiragana: hiraganaCorrect }
                        }]);
                    }
                }
            };

            // Word management functions
            const addWord = async () => {
                if (!newHiragana || !newKorean) {
                    showAlert('ÌûàÎùºÍ∞ÄÎÇòÏôÄ ÌïúÍµ≠Ïñ¥ ÎúªÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.', 'warning');
                    return;
                }

                const wordKey = newHiragana.trim();

                if (isEditMode) {
                    // Edit existing word
                    const updatedWords = { ...words };

                    if (editingWordKey !== wordKey) {
                        delete updatedWords[editingWordKey];
                    }

                    updatedWords[wordKey] = {
                        kanji: newKanji.trim() || wordKey,
                        korean: newKorean.trim()
                    };

                    setWords(updatedWords);
                    showAlert('‚úèÔ∏è Îã®Ïñ¥Í∞Ä ÏàòÏ†ïÎêòÏóàÏäµÎãàÎã§!', 'success');

                    setIsEditMode(false);
                    setEditingWordKey(null);
                } else {
                    // Add new word
                    if (words[wordKey]) {
                        const confirmed = await showCustomPopup(
                            'Ïù¥ÎØ∏ Ï°¥Ïû¨ÌïòÎäî Îã®Ïñ¥ÏûÖÎãàÎã§. ÎçÆÏñ¥Ïì∞ÏãúÍ≤†ÏäµÎãàÍπå?',
                            'Îã®Ïñ¥ Ï§ëÎ≥µ',
                            'warning',
                            true
                        );

                        if (!confirmed) return;
                    }

                    const updatedWords = {
                        ...words,
                        [wordKey]: {
                            kanji: newKanji.trim() || wordKey,
                            korean: newKorean.trim()
                        }
                    };

                    setWords(updatedWords);
                    showAlert('‚ûï Îã®Ïñ¥Í∞Ä Ï∂îÍ∞ÄÎêòÏóàÏäµÎãàÎã§!', 'success');
                }

                setNewKanji('');
                setNewHiragana('');
                setNewKorean('');
                setHangulInput('');
                setConvertedHiragana('');
                setKanjiStatus('');
                setKanjiCandidates([]);
            };

            const deleteWord = async (wordKey) => {
                const confirmed = await showCustomPopup(
                    `'${wordKey}' Îã®Ïñ¥Î•º ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?`,
                    'Îã®Ïñ¥ ÏÇ≠Ï†ú',
                    'danger',
                    true
                );

                if (confirmed) {
                    const updatedWords = { ...words };
                    delete updatedWords[wordKey];
                    setWords(updatedWords);
                    showAlert('üóëÔ∏è Îã®Ïñ¥Í∞Ä ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.', 'info');
                }
            };

            const editWord = (wordKey, data) => {
                setNewHiragana(wordKey);
                setNewKanji(data.kanji);
                setNewKorean(data.korean);
                setIsEditMode(true);
                setEditingWordKey(wordKey);
                setCurrentTab('add');
                showAlert('‚úèÔ∏è ÏàòÏ†ï Î™®ÎìúÏûÖÎãàÎã§. ÎÇ¥Ïö©ÏùÑ Î≥ÄÍ≤ΩÌïòÍ≥† Ï†ÄÏû•ÌïòÏÑ∏Ïöî.', 'info');
            };

            const cancelEdit = () => {
                setIsEditMode(false);
                setEditingWordKey(null);
                setNewKanji('');
                setNewHiragana('');
                setNewKorean('');
                setHangulInput('');
                setConvertedHiragana('');
                showAlert('‚úñÔ∏è ÏàòÏ†ïÏù¥ Ï∑®ÏÜåÎêòÏóàÏäµÎãàÎã§.', 'info');
            };

            const createNewSet = () => {
                const setName = prompt('ÏÉà Îã®Ïñ¥Ïû•Ïùò Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî:');

                if (setName && setName.trim()) {
                    const newSetId = Date.now().toString();
                    const updatedSets = { ...wordSets, [newSetId]: {} };
                    const updatedNames = { ...setNames, [newSetId]: setName.trim() };

                    setWordSets(updatedSets);
                    setSetNames(updatedNames);
                    saveAllSets(updatedSets, updatedNames, currentSetId);

                    showAlert(`üìö '${setName.trim()}' Îã®Ïñ¥Ïû•Ïù¥ ÏÉùÏÑ±ÎêòÏóàÏäµÎãàÎã§!`, 'success');
                }
            };

            const switchToSet = (setId) => {
                if (wordSets[setId]) {
                    setCurrentSetId(setId);
                    setWords(wordSets[setId]);
                    localStorage.setItem('currentWordSet', setId);
                    showAlert(`üìñ '${setNames[setId]}' Îã®Ïñ¥Ïû•ÏúºÎ°ú Ï†ÑÌôòÌñàÏäµÎãàÎã§.`, 'info');
                    setMenuOpen(false);
                }
            };

            const deleteSet = async (setId) => {
                if (setId === 'combined') {
                    showAlert('Ï†ÑÏ≤¥ Îã®Ïñ¥Ïû•ÏùÄ ÏÇ≠Ï†úÌï† Ïàò ÏóÜÏäµÎãàÎã§.', 'warning');
                    return;
                }

                const confirmed = await showCustomPopup(
                    `'${setNames[setId]}' Îã®Ïñ¥Ïû•ÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?`,
                    'Îã®Ïñ¥Ïû• ÏÇ≠Ï†ú',
                    'danger',
                    true
                );

                if (confirmed) {
                    const updatedSets = { ...wordSets };
                    const updatedNames = { ...setNames };
                    delete updatedSets[setId];
                    delete updatedNames[setId];

                    let newCurrentSet = currentSetId;
                    if (setId === currentSetId) {
                        const remainingSetIds = Object.keys(updatedSets);
                        newCurrentSet = remainingSetIds.length > 0 ? remainingSetIds[0] : '';
                    }

                    setWordSets(updatedSets);
                    setSetNames(updatedNames);
                    if (newCurrentSet !== currentSetId) {
                        setCurrentSetId(newCurrentSet);
                        setWords(newCurrentSet ? updatedSets[newCurrentSet] : {});
                    }

                    saveAllSets(updatedSets, updatedNames, newCurrentSet);
                    showAlert(`üóëÔ∏è '${setNames[setId]}' Îã®Ïñ¥Ïû•Ïù¥ ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.`, 'info');
                }
            };

            // Handle Enter key press
            const handleKeyPress = (e) => {
                if (e.key === 'Enter') {
                    if (currentTab === 'quiz' && quizStarted) {
                        if (!isAnswerSubmitted) {
                            checkAnswer();
                        } else {
                            nextQuestion();
                        }
                    } else if (currentTab === 'add') {
                        addWord();
                    }
                }
            };

            // Close menu when clicking outside
            useEffect(() => {
                const handleClickOutside = (e) => {
                    if (menuOpen && !e.target.closest('.side-menu') && !e.target.closest('.hamburger-btn')) {
                        setMenuOpen(false);
                    }
                };

                document.addEventListener('click', handleClickOutside);
                return () => document.removeEventListener('click', handleClickOutside);
            }, [menuOpen]);

            return (
                <div className="app">
                    {/* Notification */}
                    {showNotification && (
                        <div className={`notification ${notificationType}`}>
                            <span>{notificationMessage}</span>
                            <button className="notification-close" onClick={() => setShowNotification(false)}>√ó</button>
                        </div>
                    )}

                    {/* Mobile Header */}
                    <div className="mobile-header">
                        <button className="hamburger-btn" onClick={() => setMenuOpen(true)}>
                            ‚ò∞
                        </button>
                        <div className="logo">
                            üóæ ÏùºÎ≥∏Ïñ¥ Îã®Ïñ¥
                        </div>
                        <div style={{ width: '48px' }}></div>
                    </div>

                    {/* Slide-out Menu */}
                    <div className={`menu-overlay ${menuOpen ? 'show' : ''}`} onClick={() => setMenuOpen(false)}></div>
                    <div className={`side-menu ${menuOpen ? 'open' : ''}`}>
                        <button className="menu-close" onClick={() => setMenuOpen(false)}>√ó</button>

                        <div className="section-header">Îã®Ïñ¥Ïû• ÏÑ†ÌÉù</div>
                        <select
                            value={currentSetId}
                            onChange={(e) => switchToSet(e.target.value)}
                            style={{ marginBottom: '1rem' }}
                        >
                            {Object.entries(setNames).map(([setId, name]) => (
                                <option key={setId} value={setId}>{name}</option>
                            ))}
                        </select>

                        <button className="menu-item" onClick={() => { createNewSet(); setMenuOpen(false); }}>
                            ‚ûï ÏÉà Îã®Ïñ¥Ïû• ÎßåÎì§Í∏∞
                        </button>

                        <div className="section-header" style={{ marginTop: '2rem' }}>ÏÑ§Ï†ï</div>
                        <button className="menu-item" onClick={() => { setMenuOpen(false); }}>
                            ‚öôÔ∏è Ïï± ÏÑ§Ï†ï
                        </button>
                    </div>

                    {/* Main Content */}
                    <div className="main">
                        <div className="container">
                            {/* Quiz Tab */}
                            {currentTab === 'quiz' && (
                                <div>
                                    {!quizStarted ? (
                                        <div className="card">
                                            <h2 style={{ marginBottom: '2rem', color: '#667eea', fontSize: '1.8rem' }}>ÌÄ¥Ï¶à ÏãúÏûëÌïòÍ∏∞ üìù</h2>

                                            <div className="section-header">Îã®Ïñ¥ Î≤îÏúÑ</div>
                                            <div className="quiz-selector">
                                                <div
                                                    className={`quiz-option ${selectedRange === 'all' ? 'selected' : ''}`}
                                                    onClick={() => { setSelectedRange('all'); setQuizMode('all'); }}
                                                >
                                                    <div className="quiz-option-title">üìö Ï†ÑÏ≤¥ Îã®Ïñ¥</div>
                                                    <div className="quiz-option-desc">Î™®Îì† Îã®Ïñ¥Î°ú ÌÄ¥Ï¶à</div>
                                                </div>
                                                <div
                                                    className={`quiz-option ${selectedRange === 'favorites' ? 'selected' : ''}`}
                                                    onClick={() => { setSelectedRange('favorites'); setQuizMode('favorites'); }}
                                                >
                                                    <div className="quiz-option-title">‚≠ê ÌëúÏãúÌïú Îã®Ïñ¥Îßå</div>
                                                    <div className="quiz-option-desc">Ï¶êÍ≤®Ï∞æÍ∏∞ Îã®Ïñ¥Î°úÎßå ÌÄ¥Ï¶à</div>
                                                </div>
                                            </div>

                                            <div className="section-header">ÌÄ¥Ï¶à ÌÉÄÏûÖ</div>
                                            <div className="quiz-selector">
                                                <div
                                                    className={`quiz-option ${selectedType === 'korean' ? 'selected' : ''}`}
                                                    onClick={() => { setSelectedType('korean'); setQuizType('korean'); }}
                                                >
                                                    <div className="quiz-option-title">üá∞üá∑ ÌïúÍµ≠Ïñ¥ ÎßûÏ∂îÍ∏∞</div>
                                                    <div className="quiz-option-desc">ÌïúÏûê/ÌûàÎùºÍ∞ÄÎÇò ‚Üí ÌïúÍµ≠Ïñ¥</div>
                                                </div>
                                                <div
                                                    className={`quiz-option ${selectedType === 'hiragana' ? 'selected' : ''}`}
                                                    onClick={() => { setSelectedType('hiragana'); setQuizType('hiragana'); }}
                                                >
                                                    <div className="quiz-option-title">üáØüáµ ÌûàÎùºÍ∞ÄÎÇò ÎßûÏ∂îÍ∏∞</div>
                                                    <div className="quiz-option-desc">ÌïúÏûê ‚Üí ÌûàÎùºÍ∞ÄÎÇò Î∞úÏùå</div>
                                                </div>
                                                <div
                                                    className={`quiz-option ${selectedType === 'both' ? 'selected' : ''}`}
                                                    onClick={() => { setSelectedType('both'); setQuizType('both'); }}
                                                >
                                                    <div className="quiz-option-title">üí™ Îëò Îã§ ÎßûÏ∂îÍ∏∞</div>
                                                    <div className="quiz-option-desc">ÌïúÍµ≠Ïñ¥ + ÌûàÎùºÍ∞ÄÎÇò</div>
                                                </div>
                                            </div>

                                            <button className="btn btn-success" onClick={startQuiz}>
                                                üöÄ ÌÄ¥Ï¶à ÏãúÏûëÌïòÍ∏∞
                                            </button>

                                            {wrongAnswers.length > 0 && (
                                                <button
                                                    className="btn btn-warning"
                                                    onClick={() => setShowWrongAnswers(!showWrongAnswers)}
                                                >
                                                    {showWrongAnswers ? '‚ùå ÌãÄÎ¶∞ Î¨∏Ï†ú Îã´Í∏∞' : `‚ùå ÌãÄÎ¶∞ Î¨∏Ï†ú Î≥¥Í∏∞ (${wrongAnswers.length}Í∞ú)`}
                                                </button>
                                            )}

                                            {showWrongAnswers && wrongAnswers.length > 0 && (
                                                <div style={{ marginTop: '1rem' }}>
                                                    <div className="section-header">ÌãÄÎ¶∞ Î¨∏Ï†úÎì§</div>
                                                    <div className="word-list">
                                                        {wrongAnswers.map((wrongItem, index) => (
                                                            <div key={index} className="word-item" style={{
                                                                backgroundColor: 'rgba(231, 76, 60, 0.05)',
                                                                border: '2px solid #e74c3c'
                                                            }}>
                                                                <div className="word-info">
                                                                    <div className="word-kanji">{wrongItem.question}</div>
                                                                    <div className="word-hiragana">{wrongItem.hiragana}</div>
                                                                    {wrongItem.type === 'both' ? (
                                                                        <div className="word-korean">
                                                                            Ï†ïÎãµ: {wrongItem.correctKorean} / {wrongItem.correctHiragana}<br/>
                                                                            ÏûÖÎ†•: {wrongItem.userKoreanAnswer || '(ÏóÜÏùå)'} / {wrongItem.userHiraganaAnswer || '(ÏóÜÏùå)'}
                                                                        </div>
                                                                    ) : (
                                                                        <div className="word-korean">
                                                                            Ï†ïÎãµ: {wrongItem.correctAnswer}<br/>
                                                                            ÏûÖÎ†•: {wrongItem.userAnswer}
                                                                        </div>
                                                                    )}
                                                                </div>
                                                            </div>
                                                        ))}
                                                    </div>
                                                </div>
                                            )}
                                        </div>
                                    ) : (
                                        <div
                                            className="quiz-card-fullscreen"
                                            onTouchStart={handleTouchStart}
                                            onTouchEnd={handleTouchEnd}
                                        >
                                            <div className="score">
                                                üìä {score} / {totalQuestions}
                                            </div>

                                            {currentWord && (
                                                <div className="quiz-word" style={{ position: 'relative' }}>
                                                    <button
                                                        className="quiz-favorite-btn"
                                                        style={{
                                                            background: getCurrentSetFavorites()[currentWord.hiragana]
                                                                ? 'linear-gradient(45deg, #f39c12, #e67e22)'
                                                                : 'rgba(189, 195, 199, 0.9)'
                                                        }}
                                                        onClick={() => toggleWordFavorite(currentWord.hiragana)}
                                                    >
                                                        {getCurrentSetFavorites()[currentWord.hiragana] ? '‚≠ê' : '‚òÜ'}
                                                    </button>

                                                    <div className="kanji">
                                                        {currentWord.kanji || currentWord.hiragana}
                                                    </div>

                                                    {quizType !== 'hiragana' && (
                                                        <div className="hiragana-container">
                                                            {hideHiragana ? (
                                                                <>
                                                                    <div className="hiragana hiragana-hidden">
                                                                        {currentWord.hiragana}
                                                                    </div>
                                                                    <div
                                                                        className="hiragana-overlay"
                                                                        onClick={() => setHideHiragana(false)}
                                                                    >
                                                                        üëÜ ÌÉ≠ÌïòÏó¨ Î≥¥Í∏∞
                                                                    </div>
                                                                </>
                                                            ) : (
                                                                <div
                                                                    className="hiragana"
                                                                    onClick={() => setHideHiragana(true)}
                                                                >
                                                                    {currentWord.hiragana}
                                                                </div>
                                                            )}
                                                        </div>
                                                    )}
                                                </div>
                                            )}

                                            {quizType === 'korean' && (
                                                <div className="input-group">
                                                    <label className="input-label">ÌïúÍµ≠Ïñ¥ ÎúªÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî</label>
                                                    <input
                                                        type="text"
                                                        className="input-field"
                                                        value={userAnswer}
                                                        onChange={(e) => setUserAnswer(e.target.value)}
                                                        onKeyPress={handleKeyPress}
                                                        placeholder="Ïòà: ÌïôÍµê"
                                                        disabled={isAnswerSubmitted}
                                                        autoFocus
                                                    />
                                                </div>
                                            )}

                                            {quizType === 'hiragana' && (
                                                <div className="input-group">
                                                    <label className="input-label">ÌûàÎùºÍ∞ÄÎÇò Î∞úÏùåÏùÑ ÌïúÍ∏ÄÎ°ú ÏûÖÎ†•ÌïòÏÑ∏Ïöî</label>
                                                    <input
                                                        type="text"
                                                        className="input-field"
                                                        value={userAnswer}
                                                        onChange={(e) => setUserAnswer(e.target.value)}
                                                        onKeyPress={handleKeyPress}
                                                        placeholder="Ïòà: Í∞ìÏΩîÏö∞"
                                                        disabled={isAnswerSubmitted}
                                                        autoFocus
                                                    />
                                                    {convertedQuizAnswer && (
                                                        <div className="hangul-converter">
                                                            <strong>Î≥ÄÌôò:</strong> {convertedQuizAnswer}
                                                        </div>
                                                    )}
                                                </div>
                                            )}

                                            {quizType === 'both' && (
                                                <>
                                                    <div className="input-group">
                                                        <label className="input-label">
                                                            1Ô∏è‚É£ ÌïúÍµ≠Ïñ¥ Îúª
                                                            {bothQuizResult.korean !== null && (
                                                                <span style={{
                                                                    marginLeft: '0.5rem',
                                                                    color: bothQuizResult.korean ? '#27ae60' : '#e74c3c'
                                                                }}>
                                                                    {bothQuizResult.korean ? '‚úÖ' : '‚ùå'}
                                                                </span>
                                                            )}
                                                        </label>
                                                        <input
                                                            type="text"
                                                            className="input-field"
                                                            value={userKoreanAnswer}
                                                            onChange={(e) => setUserKoreanAnswer(e.target.value)}
                                                            placeholder="Ïòà: ÌïôÍµê"
                                                            disabled={isAnswerSubmitted}
                                                            autoFocus
                                                        />
                                                    </div>

                                                    <div className="input-group">
                                                        <label className="input-label">
                                                            2Ô∏è‚É£ ÌûàÎùºÍ∞ÄÎÇò Î∞úÏùå (ÌïúÍ∏ÄÎ°ú)
                                                            {bothQuizResult.hiragana !== null && (
                                                                <span style={{
                                                                    marginLeft: '0.5rem',
                                                                    color: bothQuizResult.hiragana ? '#27ae60' : '#e74c3c'
                                                                }}>
                                                                    {bothQuizResult.hiragana ? '‚úÖ' : '‚ùå'}
                                                                </span>
                                                            )}
                                                        </label>
                                                        <input
                                                            type="text"
                                                            className="input-field"
                                                            value={userHiraganaAnswer}
                                                            onChange={(e) => setUserHiraganaAnswer(e.target.value)}
                                                            onKeyPress={handleKeyPress}
                                                            placeholder="Ïòà: Í∞ìÏΩîÏö∞"
                                                            disabled={isAnswerSubmitted}
                                                        />
                                                        {convertedHiraganaAnswer && (
                                                            <div className="hangul-converter">
                                                                <strong>Î≥ÄÌôò:</strong> {convertedHiraganaAnswer}
                                                            </div>
                                                        )}
                                                    </div>
                                                </>
                                            )}

                                            {result && (
                                                <div className={`result ${result}`}>
                                                    {result === 'correct' && 'üéâ Ï†ïÎãµÏûÖÎãàÎã§!'}
                                                    {result === 'incorrect' && (
                                                        <>
                                                            ‚ùå ÌãÄÎ†∏ÏäµÎãàÎã§<br/>
                                                            {quizType === 'korean' && `Ï†ïÎãµ: ${currentWord.korean}`}
                                                            {quizType === 'hiragana' && `Ï†ïÎãµ: ${currentWord.hiragana}`}
                                                            {quizType === 'both' && (
                                                                <>
                                                                    Ï†ïÎãµ: {currentWord.korean} / {currentWord.hiragana}
                                                                </>
                                                            )}
                                                        </>
                                                    )}
                                                    {result === 'partial' && (
                                                        <>
                                                            ‚ö†Ô∏è Ìïú Í∞úÎßå Ï†ïÎãµ!<br/>
                                                            Ï†ïÎãµ: {currentWord.korean} / {currentWord.hiragana}
                                                        </>
                                                    )}
                                                </div>
                                            )}

                                            <div className="btn-group">
                                                {!isAnswerSubmitted ? (
                                                    <button className="btn btn-primary" onClick={checkAnswer}>
                                                        ‚úì Ï†ïÎãµ ÌôïÏù∏
                                                    </button>
                                                ) : (
                                                    <button className="btn btn-success" onClick={nextQuestion}>
                                                        ‚û°Ô∏è Îã§Ïùå Î¨∏Ï†ú
                                                    </button>
                                                )}
                                                <button
                                                    className="btn btn-danger"
                                                    onClick={() => {
                                                        setQuizStarted(false);
                                                        setResult(null);
                                                    }}
                                                >
                                                    ‚èπÔ∏è ÌÄ¥Ï¶à Ï¢ÖÎ£å
                                                </button>
                                            </div>

                                            {isAnswerSubmitted && (
                                                <div className="swipe-indicator">
                                                    üëà ÏôºÏ™ΩÏúºÎ°ú Ïä§ÏôÄÏù¥ÌîÑÌïòÏó¨ Îã§Ïùå Î¨∏Ï†ú
                                                </div>
                                            )}
                                        </div>
                                    )}
                                </div>
                            )}

                            {/* Words Tab */}
                            {currentTab === 'words' && (
                                <div className="card">
                                    <h2 style={{ marginBottom: '1.5rem', color: '#667eea', fontSize: '1.8rem' }}>
                                        Îã®Ïñ¥Ïû• üìö
                                    </h2>

                                    <div className="search-bar">
                                        <span className="search-icon">üîç</span>
                                        <input
                                            type="text"
                                            className="search-input"
                                            placeholder="Îã®Ïñ¥ Í≤ÄÏÉâ..."
                                            value={searchQuery}
                                            onChange={(e) => setSearchQuery(e.target.value)}
                                        />
                                    </div>

                                    <div className="toggle-container" onClick={() => setShowFavoritesOnly(!showFavoritesOnly)}>
                                        <span className="toggle-label">‚≠ê ÌëúÏãúÌïú Îã®Ïñ¥Îßå Î≥¥Í∏∞</span>
                                        <div className={`toggle-switch ${showFavoritesOnly ? 'active' : ''}`}>
                                            <div className="toggle-knob"></div>
                                        </div>
                                    </div>

                                    <div style={{ marginBottom: '1rem', padding: '1rem', background: 'rgba(102, 126, 234, 0.1)', borderRadius: '12px' }}>
                                        <strong>Ï¥ù {Object.keys(getFilteredWords()).length}Í∞ú Îã®Ïñ¥</strong>
                                    </div>

                                    {Object.keys(getFilteredWords()).length === 0 ? (
                                        <div className="empty-state">
                                            <div className="empty-state-icon">üìù</div>
                                            <div className="empty-state-text">Îã®Ïñ¥Í∞Ä ÏóÜÏäµÎãàÎã§</div>
                                            <button className="btn btn-primary" onClick={() => setCurrentTab('add')}>
                                                ‚ûï Îã®Ïñ¥ Ï∂îÍ∞ÄÌïòÍ∏∞
                                            </button>
                                        </div>
                                    ) : (
                                        <div className="word-list">
                                            {Object.entries(getFilteredWords()).map(([hiragana, data]) => {
                                                const isFavorite = getCurrentSetFavorites()[hiragana];
                                                return (
                                                    <div key={hiragana} className="word-item" style={{
                                                        border: isFavorite ? '2px solid #f39c12' : '1px solid #e1e8ed',
                                                        backgroundColor: isFavorite ? 'rgba(241, 196, 15, 0.05)' : 'transparent'
                                                    }}>
                                                        <div className="word-info">
                                                            <div className="word-kanji">{data.kanji}</div>
                                                            <div className="word-hiragana">{hiragana}</div>
                                                            <div className="word-korean">{data.korean}</div>
                                                        </div>
                                                        <div className="word-actions">
                                                            <button
                                                                className="icon-btn"
                                                                onClick={() => toggleWordFavorite(hiragana)}
                                                                style={{ color: isFavorite ? '#f39c12' : '#bdc3c7' }}
                                                            >
                                                                {isFavorite ? '‚≠ê' : '‚òÜ'}
                                                            </button>
                                                            <button
                                                                className="icon-btn"
                                                                onClick={() => editWord(hiragana, data)}
                                                                style={{ color: '#3498db' }}
                                                            >
                                                                ‚úèÔ∏è
                                                            </button>
                                                            <button
                                                                className="icon-btn"
                                                                onClick={() => deleteWord(hiragana)}
                                                                style={{ color: '#e74c3c' }}
                                                            >
                                                                üóëÔ∏è
                                                            </button>
                                                        </div>
                                                    </div>
                                                );
                                            })}
                                        </div>
                                    )}
                                </div>
                            )}

                            {/* Add Tab */}
                            {currentTab === 'add' && (
                                <div className="card">
                                    <h2 style={{ marginBottom: '1.5rem', color: '#667eea', fontSize: '1.8rem' }}>
                                        {isEditMode ? '‚úèÔ∏è Îã®Ïñ¥ ÏàòÏ†ï' : '‚ûï Îã®Ïñ¥ Ï∂îÍ∞Ä'}
                                    </h2>

                                    <div className="input-group">
                                        <label className="input-label">ÌïúÍ∏Ä Î∞úÏùå ÏûÖÎ†•</label>
                                        <input
                                            type="text"
                                            className="input-field"
                                            value={hangulInput}
                                            onChange={(e) => setHangulInput(e.target.value)}
                                            placeholder="Ïòà: Í∞ìÏΩîÏö∞"
                                        />
                                        {convertedHiragana && (
                                            <div className="hangul-converter">
                                                <strong>ÌûàÎùºÍ∞ÄÎÇò:</strong> {convertedHiragana}
                                                <button
                                                    className="btn btn-primary"
                                                    style={{ marginTop: '0.5rem' }}
                                                    onClick={() => setNewHiragana(convertedHiragana)}
                                                >
                                                    ‚úì ÏÇ¨Ïö©ÌïòÍ∏∞
                                                </button>
                                            </div>
                                        )}
                                    </div>

                                    <div className="input-group">
                                        <label className="input-label">ÌûàÎùºÍ∞ÄÎÇò *</label>
                                        <input
                                            type="text"
                                            className="input-field"
                                            value={newHiragana}
                                            onChange={(e) => setNewHiragana(e.target.value)}
                                            placeholder="„Åå„Å£„Åì„ÅÜ"
                                        />
                                    </div>

                                    <div className="input-group">
                                        <label className="input-label">ÌïúÏûê</label>
                                        <input
                                            type="text"
                                            className="input-field"
                                            value={newKanji}
                                            onChange={(e) => setNewKanji(e.target.value)}
                                            placeholder="Â≠¶Ê†°"
                                        />
                                        {kanjiStatus && (
                                            <div className="status-indicator status-info">
                                                {kanjiStatus}
                                            </div>
                                        )}
                                    </div>

                                    {kanjiCandidates.length > 0 && (
                                        <div>
                                            <div className="section-header">ÌïúÏûê ÌõÑÎ≥¥</div>
                                            {kanjiCandidates.map((candidate, index) => (
                                                <button
                                                    key={index}
                                                    className="candidate-btn"
                                                    onClick={() => setNewKanji(candidate.kanji)}
                                                >
                                                    <strong>{candidate.kanji}</strong> - {candidate.reading}
                                                    {candidate.meanings && (
                                                        <div style={{ fontSize: '0.9rem', color: '#7f8c8d', marginTop: '0.25rem' }}>
                                                            {candidate.meanings}
                                                        </div>
                                                    )}
                                                </button>
                                            ))}
                                        </div>
                                    )}

                                    <div className="input-group">
                                        <label className="input-label">ÌïúÍµ≠Ïñ¥ Îúª *</label>
                                        <input
                                            type="text"
                                            className="input-field"
                                            value={newKorean}
                                            onChange={(e) => setNewKorean(e.target.value)}
                                            onKeyPress={handleKeyPress}
                                            placeholder="ÌïôÍµê"
                                        />
                                    </div>

                                    <div className="btn-group">
                                        <button className="btn btn-success" onClick={addWord}>
                                            {isEditMode ? '‚úì ÏàòÏ†ï ÏôÑÎ£å' : '‚ûï Îã®Ïñ¥ Ï∂îÍ∞Ä'}
                                        </button>
                                        {isEditMode && (
                                            <button className="btn btn-danger" onClick={cancelEdit}>
                                                ‚úñÔ∏è ÏàòÏ†ï Ï∑®ÏÜå
                                            </button>
                                        )}
                                    </div>
                                </div>
                            )}

                            {/* Data Tab */}
                            {currentTab === 'data' && (
                                <div className="card">
                                    <h2 style={{ marginBottom: '1.5rem', color: '#667eea', fontSize: '1.8rem' }}>
                                        Îç∞Ïù¥ÌÑ∞ Í¥ÄÎ¶¨ üíæ
                                    </h2>

                                    <div className="section-header">Îã®Ïñ¥Ïû• Í¥ÄÎ¶¨</div>
                                    <div className="btn-group">
                                        <button className="btn btn-primary" onClick={createNewSet}>
                                            ‚ûï ÏÉà Îã®Ïñ¥Ïû• ÎßåÎì§Í∏∞
                                        </button>
                                    </div>

                                    <div className="section-header">ÌòÑÏû¨ Îã®Ïñ¥Ïû•</div>
                                    <select
                                        value={currentSetId}
                                        onChange={(e) => switchToSet(e.target.value)}
                                    >
                                        {Object.entries(setNames).map(([setId, name]) => (
                                            <option key={setId} value={setId}>
                                                {name} ({Object.keys(wordSets[setId] || {}).length}Í∞ú)
                                            </option>
                                        ))}
                                    </select>

                                    {currentSetId && currentSetId !== 'combined' && (
                                        <button
                                            className="btn btn-danger"
                                            onClick={() => deleteSet(currentSetId)}
                                            style={{ marginTop: '1rem' }}
                                        >
                                            üóëÔ∏è ÌòÑÏû¨ Îã®Ïñ¥Ïû• ÏÇ≠Ï†ú
                                        </button>
                                    )}

                                    <div className="section-header" style={{ marginTop: '2rem' }}>Î∞±ÏóÖ & Î≥µÏõê</div>
                                    <div style={{
                                        background: 'rgba(52, 152, 219, 0.1)',
                                        padding: '1rem',
                                        borderRadius: '12px',
                                        marginBottom: '1rem',
                                        fontSize: '0.95rem',
                                        color: '#2c3e50'
                                    }}>
                                        üí° Îã®Ïñ¥Ïû• Îç∞Ïù¥ÌÑ∞Î•º JSON ÌååÏùºÎ°ú Î∞±ÏóÖÌïòÍ±∞ÎÇò Î≥µÏõêÌï† Ïàò ÏûàÏäµÎãàÎã§.
                                    </div>
                                    <div className="btn-group">
                                        <button className="btn btn-success">
                                            üìÅ JSONÏúºÎ°ú ÎÇ¥Î≥¥ÎÇ¥Í∏∞
                                        </button>
                                        <label className="btn btn-warning" style={{ margin: 0 }}>
                                            üìÇ JSONÏóêÏÑú Í∞ÄÏ†∏Ïò§Í∏∞
                                            <input type="file" accept=".json" style={{ display: 'none' }} />
                                        </label>
                                    </div>
                                </div>
                            )}

                            {/* Kanji Lookup Tab */}
                            {currentTab === 'kanji' && (
                                <div className="card">
                                    <h2 style={{ marginBottom: '1.5rem', color: '#667eea', fontSize: '1.8rem' }}>
                                        ÌïúÏûê Î∞úÏùå Ï∞æÍ∏∞ üîç
                                    </h2>

                                    <div className="input-group">
                                        <label className="input-label">ÌïúÏûêÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî</label>
                                        <input
                                            type="text"
                                            className="input-field"
                                            value={kanjiInput}
                                            onChange={(e) => setKanjiInput(e.target.value)}
                                            placeholder="Ïòà: Â≠¶Ê†°"
                                        />
                                    </div>

                                    <button className="btn btn-primary">
                                        üîç Î∞úÏùå Ï∞æÍ∏∞
                                    </button>

                                    <div style={{
                                        background: 'rgba(52, 152, 219, 0.1)',
                                        padding: '1.5rem',
                                        borderRadius: '12px',
                                        marginTop: '1.5rem',
                                        textAlign: 'center',
                                        color: '#7f8c8d'
                                    }}>
                                        ÌïúÏûêÎ•º ÏûÖÎ†•ÌïòÍ≥† Î∞úÏùå Ï∞æÍ∏∞ Î≤ÑÌäºÏùÑ ÎàåÎü¨Ï£ºÏÑ∏Ïöî
                                    </div>
                                </div>
                            )}

                            {/* Learn Mode Tab */}
                            {currentTab === 'learn' && (
                                <div className="card">
                                    <h2 style={{ marginBottom: '1.5rem', color: '#667eea', fontSize: '1.8rem' }}>
                                        ÌïôÏäµ Î™®Îìú üìñ
                                    </h2>

                                    {!learnStarted ? (
                                        <>
                                            <div className="section-header">ÌïôÏäµ Î≤îÏúÑ</div>
                                            <div className="quiz-selector">
                                                <div
                                                    className={`quiz-option ${learnMode === 'all' ? 'selected' : ''}`}
                                                    onClick={() => setLearnMode('all')}
                                                >
                                                    <div className="quiz-option-title">üìö Ï†ÑÏ≤¥ Îã®Ïñ¥</div>
                                                    <div className="quiz-option-desc">Î™®Îì† Îã®Ïñ¥ ÌïôÏäµ</div>
                                                </div>
                                                <div
                                                    className={`quiz-option ${learnMode === 'favorites' ? 'selected' : ''}`}
                                                    onClick={() => setLearnMode('favorites')}
                                                >
                                                    <div className="quiz-option-title">‚≠ê ÌëúÏãúÌïú Îã®Ïñ¥Îßå</div>
                                                    <div className="quiz-option-desc">Ï¶êÍ≤®Ï∞æÍ∏∞Îßå ÌïôÏäµ</div>
                                                </div>
                                            </div>

                                            <button className="btn btn-success">
                                                üöÄ ÌïôÏäµ ÏãúÏûëÌïòÍ∏∞
                                            </button>
                                        </>
                                    ) : (
                                        <div className="empty-state">
                                            <div className="empty-state-icon">üìñ</div>
                                            <div className="empty-state-text">ÌïôÏäµ Î™®ÎìúÎäî Ï§ÄÎπÑ Ï§ëÏûÖÎãàÎã§</div>
                                        </div>
                                    )}
                                </div>
                            )}
                        </div>
                    </div>

                    {/* Bottom Navigation */}
                    <div className="bottom-nav">
                        <button
                            className={`nav-item ${currentTab === 'quiz' ? 'active' : ''}`}
                            onClick={() => setCurrentTab('quiz')}
                        >
                            <div className="nav-icon">üìù</div>
                            <div className="nav-label">ÌÄ¥Ï¶à</div>
                        </button>
                        <button
                            className={`nav-item ${currentTab === 'words' ? 'active' : ''}`}
                            onClick={() => setCurrentTab('words')}
                        >
                            <div className="nav-icon">üìö</div>
                            <div className="nav-label">Îã®Ïñ¥Ïû•</div>
                        </button>
                        <button
                            className={`nav-item ${currentTab === 'add' ? 'active' : ''}`}
                            onClick={() => setCurrentTab('add')}
                        >
                            <div className="nav-icon">‚ûï</div>
                            <div className="nav-label">Ï∂îÍ∞Ä</div>
                        </button>
                        <button
                            className={`nav-item ${currentTab === 'data' ? 'active' : ''}`}
                            onClick={() => setCurrentTab('data')}
                        >
                            <div className="nav-icon">üíæ</div>
                            <div className="nav-label">Í¥ÄÎ¶¨</div>
                        </button>
                        <button
                            className={`nav-item ${currentTab === 'learn' ? 'active' : ''}`}
                            onClick={() => setCurrentTab('learn')}
                        >
                            <div className="nav-icon">üìñ</div>
                            <div className="nav-label">ÌïôÏäµ</div>
                        </button>
                    </div>

                    {/* Desktop Version Link */}
                    <a href="index.html" className="desktop-link">
                        üñ•Ô∏è Îç∞Ïä§ÌÅ¨ÌÜ± Î≤ÑÏ†ÑÏúºÎ°ú Ïù¥Îèô
                    </a>
                </div>
            );
        }

        // Render the app
        ReactDOM.render(<JapaneseStudyApp />, document.getElementById('root'));
    </script>
</body>
</html>
